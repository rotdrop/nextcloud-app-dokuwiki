{"version":3,"file":"js/app-7f17b9c7bd2021267fcd.js","mappings":"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","sources":["webpack://@rotdrop/nextcloud-app-dokuwiki/./appinfo/info.xml","webpack://@rotdrop/nextcloud-app-dokuwiki/webpack/bootstrap","webpack://@rotdrop/nextcloud-app-dokuwiki/./src/config.js","webpack://@rotdrop/nextcloud-app-dokuwiki/./src/doku-wiki.js","webpack://@rotdrop/nextcloud-app-dokuwiki/./src/index.js","webpack://@rotdrop/nextcloud-app-dokuwiki/./src/toolkit/util/on-document-loaded.js"],"sourcesContent":["module.exports = {\"info\":{\"$\":{\"xmlns:xsi\":\"http://www.w3.org/2001/XMLSchema-instance\",\"xsi:noNamespaceSchemaLocation\":\"https://apps.nextcloud.com/schema/apps/info.xsd\"},\"id\":[\"dokuwiki\"],\"name\":[\"DokuWiki Integration\"],\"summary\":[\"Embed an existing DokuWiki instance into Nextcloud, potentially with SSO.\"],\"description\":[\"Embed an existing DokuWiki instance into Nextcloud, potentially with SSO. For SSO DokuWiki users and Nextcloud users have to coincide, e.g. by using a common authentication backend like LDAP, or with an appropriate auth plugin on either side of the integration.\"],\"version\":[\"1.0.1\"],\"licence\":[\"agpl\"],\"author\":[{\"_\":\"Claus-Justus Heine\",\"$\":{\"mail\":\"himself@claus-justus-heine.de\",\"homepage\":\"https://www.claus-justus-heine.de\"}}],\"namespace\":[\"DokuWiki\"],\"category\":[\"integration\",\"organization\",\"social\"],\"bugs\":[\"https://github.com/rotdrop/nextcloud-app-dokuwiki\"],\"dependencies\":[{\"nextcloud\":[{\"$\":{\"min-version\":\"25\",\"max-version\":\"27\"}}],\"php\":[{\"$\":{\"min-version\":\"8.0.2\",\"max-version\":\"8.2\"}}]}],\"navigations\":[{\"navigation\":[{\"name\":[\"DokuWiki\"],\"route\":[\"dokuwiki.page.index\"]}]}],\"settings\":[{\"admin\":[\"OCA\\\\DokuWiki\\\\Settings\\\\Admin\"],\"admin-section\":[\"OCA\\\\DokuWiki\\\\Settings\\\\AdminSection\"]}],\"screenshot\":[\"https://github.com/rotdrop/nextcloud-app-dokuwiki/raw/master/contrib/screenshots/start-page.png\",\"https://github.com/rotdrop/nextcloud-app-dokuwiki/raw/master/contrib/screenshots/admin-settings.png\",\"https://github.com/rotdrop/nextcloud-app-dokuwiki/raw/master/contrib/screenshots/jquery-popup.png\"]}}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * Nextcloud RoundCube App.\n *\n * @author Claus-Justus Heine\n * @copyright 2020, 2021, 2023 Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * Nextcloud RoundCube App is free software: you can redistribute it and/or\n * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * Nextcloud RoundCube App is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * AFFERO GENERAL PUBLIC LICENSE for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License along with Nextcloud RoundCube App. If not, see\n * <http://www.gnu.org/licenses/>.\n */\n\nconst appInfo = require('../appinfo/info.xml');\nconst appName = appInfo.info.id[0];\n\nexport {\n  appInfo,\n  appName,\n};\n","/**\n * DokuWikiEmbedded -- Embed DokuWiki into NextCloud with SSO.\n *\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n * @copyright 2020, 2021, 2023 Claus-Justus Heine\n * @license AGPL-3.0-or-later\n *\n * DokuWikiEmbedded is free software: you can redistribute it and/or\n * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * DokuWikiEmbedded is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * AFFERO GENERAL PUBLIC LICENSE for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License along with DokuWikiEmbedded. If not, see\n * <http://www.gnu.org/licenses/>.\n */\n\nimport { appName } from './config.js';\n\nimport '../style/doku-wiki.scss';\n\nconst webPrefix = appName;\n\n/**\n * Called after the DokuWiki has been loaded by the iframe. We make\n * sure that external links are opened in another tab/window.\n *\n * @param {object} frame TBD.\n *\n * @param {object} frameWrapper TBD.\n *\n * @param {Function} callback TBD.\n *\n */\nconst loadHandler = function(frame, frameWrapper, callback) {\n\n  const frameDocument = frame.contentWindow.document;\n\n  frameDocument.querySelectorAll('.logout').forEach(el => el.remove());\n  frameDocument.querySelectorAll('li:empty').forEach(el => el.remove());\n  frameDocument.querySelectorAll('form.btn_logout').forEach(el => el.remove());\n  frameDocument.querySelectorAll(':scope #dokuwiki__usertools li.user').forEach(el => el.remove());\n  frameDocument.querySelectorAll(':scope #dokuwiki__usertools li.action.profile').forEach(el => el.remove());\n\n  frameDocument.querySelectorAll('a').forEach(el => {\n    if (el.hostname && el.hostname !== window.location.hostname) {\n      el.setAttribute('target', '_blank');\n    }\n  });\n\n  const previewDiv = frameDocument.querySelector('div.preview');\n  if (previewDiv) {\n    // make sure that links in the preview pane are NOT followed.\n    previewDiv.querySelectorAll('a[class^=\"wikilink\"]').forEach(el => {\n      el.addEventListener('click', function(event) {\n        event.stopPropagation();\n        event.preventDefault();\n        const href = event.target.getAttribute('href').replace(/^\\/[^?]+\\?id=(.*)$/, '$1');\n        OC.dialogs.alert(\n          t(appName, 'Links to wiki pages are disabled in preview mode.'),\n          t(appName, 'Link to wiki page') + ' \"' + href + '\"');\n      }, true);\n    });\n    previewDiv.querySelectorAll('a[class^=\"media\"]').forEach(el => {\n      el.addEventListener('click', function(event) {\n        event.stopPropagation();\n        event.preventDefault();\n        const href = event.target.getAttribute('href').replace(/^\\/[^?]+\\?id=(.*)$/, '$1');\n        OC.dialogs.alert(\n          t(appName, 'Links to media files are disabled in preview mode.'),\n          t(appName, 'Link to wiki page') + ' \"' + href + '\"');\n      }, true);\n    });\n  }\n\n  if (typeof callback === 'undefined') {\n    callback = function() {};\n  }\n\n  const loader = document.getElementById(webPrefix + 'Loader');\n  loader.classList.add('fading');\n  frame.classList.remove('faded');\n  callback(frame, frameWrapper);\n};\n\nexport { loadHandler };\n","/**\n * DokuWikiEmbedded -- Embed DokuWiki into NextCloud with SSO.\n *\n * @author Claus-Justus Heine\n * @copyright 2020, 2021, 2023 Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * DokuWikiEmbedded is free software: you can redistribute it and/or\n * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * DokuWikiEmbedded is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * AFFERO GENERAL PUBLIC LICENSE for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License along with DokuWikiEmbedded. If not, see\n * <http://www.gnu.org/licenses/>.\n */\n\nimport { appName } from './config.js';\nimport onDocumentLoaded from './toolkit/util/on-document-loaded.js';\nimport { loadHandler } from './doku-wiki.js';\n\nimport '../style/doku-wiki.scss';\n\nconst webPrefix = appName;\n\nonDocumentLoaded(() => {\n  console.info('DokuWiki webPrefix', webPrefix);\n  const frameWrapper = document.getElementById(webPrefix + 'FrameWrapper');\n  const frame = document.getElementById(webPrefix + 'Frame');\n\n  const setHeightCallback = function() {\n    const height = window.innerHeight - frame.getBoundingClientRect().top;\n    frame.style.height = height + 'px';\n    const outerDelta = frame.getBoundingClientRect().height - frame.clientHeight;\n    if (outerDelta) {\n      frame.style.height = (height - outerDelta) + 'px';\n    }\n  };\n\n  if (frame) {\n    frame.addEventListener('load', () => loadHandler(frame, frameWrapper, setHeightCallback));\n\n    let resizeTimer;\n    window.addEventListener('resize', () => {\n      clearTimeout(resizeTimer);\n      resizeTimer = setTimeout(setHeightCallback);\n    });\n    if (frame.contentWindow.document.querySelector('.logout')\n        || frame.contentWindow.document.querySelector('.login')) {\n      loadHandler(frame, frameWrapper, setHeightCallback);\n    }\n  }\n});\n","/**\n * @copyright Copyright (c) 2022, 2023 Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nconst onDocumentLoaded = (callback) => {\n  if (document.readyState !== 'loading') {\n    callback();\n  } else {\n    document.addEventListener('DOMContentLoaded', callback);\n  }\n};\n\nexport default onDocumentLoaded;\n"],"names":["module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","appName","require","info","id","webPrefix","loadHandler","frame","frameWrapper","callback","frameDocument","contentWindow","document","querySelectorAll","forEach","el","remove","hostname","window","location","setAttribute","previewDiv","querySelector","addEventListener","event","stopPropagation","preventDefault","href","target","getAttribute","replace","OC","dialogs","alert","t","getElementById","classList","add","readyState","onDocumentLoaded","console","resizeTimer","setHeightCallback","height","innerHeight","getBoundingClientRect","top","style","outerDelta","clientHeight","clearTimeout","setTimeout"],"sourceRoot":""}